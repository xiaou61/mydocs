import{_ as o}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as e,o as c,c as l,a as n,b as s,d as t,e as p}from"./app.c5b3201b.js";const i={},u=n("p",null,"使用金山文档的每日定时任务，执行阿里云盘签到接口。",-1),r={href:"https://link.zhihu.com/?target=https%3A//kdocs.cn/l/ceQR4HpZ6op1",target:"_blank",rel:"noopener noreferrer"},k=p('<h3 id="_1-日志效果展示" tabindex="-1"><a class="header-anchor" href="#_1-日志效果展示" aria-hidden="true">#</a> <strong>1.日志效果展示：</strong></h3><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103747.webp" alt="img" loading="lazy"></p><h3 id="_2-邮箱效果展示" tabindex="-1"><a class="header-anchor" href="#_2-邮箱效果展示" aria-hidden="true">#</a> 2.邮箱效果展示：</h3><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103772.webp" alt="img" loading="lazy"></p><p>单/多账号下只发送与对应账号相关内容</p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251104395.webp" alt="img" loading="lazy"></p><p>一个人多个账号签到信息也是单独发送</p><h3 id="_3-表格创建" tabindex="-1"><a class="header-anchor" href="#_3-表格创建" aria-hidden="true">#</a> 3.表格创建：</h3><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251105002.webp" alt="img" loading="lazy"></p><p>请创建普通表格，智能表格定时签到不生效</p><h3 id="_4-多账号单独管理" tabindex="-1"><a class="header-anchor" href="#_4-多账号单独管理" aria-hidden="true">#</a> 4.多账号单独管理：</h3>',11),d={href:"https://link.zhihu.com/?target=https%3A//kdocs.cn/l/ceQR4HpZ6op1",target:"_blank",rel:"noopener noreferrer"},m=p(`<p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103774.webp" alt="img" loading="lazy"></p><p>对原有模版进行修改</p><h3 id="_5-新增内容" tabindex="-1"><a class="header-anchor" href="#_5-新增内容" aria-hidden="true">#</a> 5.新增内容：</h3><ul><li><p><strong>新增给多账号发送邮件</strong><strong>实现原理</strong>：使用循环变量来读取表单中的邮箱地址，直到遇到空值为止。每次读取到一个邮箱地址，都将其添加 到<code>jsyxList</code>数组中。然后，通过循环遍历<code>jsyxList</code>数组，并为每个邮箱地址发送邮件。</p></li><li><p><strong>新增每个人的签到内容只会发送给同一行的对应邮箱地址</strong> **实现原理：**将循环的范围从2到20改为对于每一行数据，获取对应的<code>refresh_token</code>、<code>sflq</code>和<code>jsyx</code>的值，并进行相应的判断和处理。如果<code>refresh_token</code>、<code>sflq</code>和<code>jsyx</code>的值符合条件（不为空且需要领取奖励且有接收邮箱地址），则进行签到和发送邮件的操作。签到成功后，将相关的签到内容存储在<code>value</code>变量中，然后将其发送给对应的邮箱地址。</p></li><li><p><strong>新增邮件发送状态,监测发送邮件成功与失败</strong> *<em>实现原理：<strong>在签到成功后使用<code>log</code>函数单独打印了&quot;账号：13X</strong></em>XXX-签到成功&quot;的日志。然后，在发送邮件时，在调用<code>log</code>函数之前将签到内容存储在<code>value</code>变量中，并使用了<code>try...catch</code>语句来捕获邮件发送时可能发生的错误。在成功发送邮件时，会将成功信息记录到日志中，而在发送失败时，会将失败的具体错误信息记录到日志中。</p></li><li><p><strong>新增每月最后一天，自动领取未领取的奖励</strong> **实现原理：**使用 <code>Date</code> 对象获取当前日期和时间信息，并通过相关方法获得当前日期的字符串表示和月份的最后一天。然后，通过 <code>for</code> 循环遍历奖励数据的行，逐行获取相关数据进行处理。</p></li></ul><h3 id="_6-代码对比" tabindex="-1"><a class="header-anchor" href="#_6-代码对比" aria-hidden="true">#</a> 6.代码对比：</h3><p>对比最初的代码，以下是对代码进行的优化和改进的列表：</p><ol><li>引入日期时间处理：添加了获取当前日期并格式化的功能，使用toLocaleDateString方法获取当前日期，并将其作为签到通知的主题一部分。</li><li>函数封装：将延迟等待的逻辑封装成了sleep函数，用于等待一段时间。这使得代码更加模块化和可读性更高。</li><li>错误处理和异常捕获：在发起网络请求和其他关键操作中增加了错误处理和异常捕获的逻辑，以便在出现错误时能够提供错误提示并及时终止代码的执行。</li><li>优化日志输出：在代码中添加了日志输出函数log，用于将信息打印到控制台，并在发送邮件时打印相应的状态和错误信息。</li><li>变量命名优化：对部分变量进行了更具描述性的命名，使代码更易读。</li><li>代码结构清晰：3.0代码使用了更具描述性的变量命名，并将不同功能的代码块进行了适当的分离，提高了代码的可读性和可维护性。</li><li>循环遍历优化：使用了<code>let</code>关键字声明循环变量<code>row</code>，避免了变量作用域的问题。同时，将循环起始值和结束条件直接写在循环语句中，简化了代码。</li><li>列索引灵活配置：通过在代码中定义变量<code>tokenColumn</code>、<code>signInColumn</code>等，可以根据需求方便地修改Excel表格中各列的索引，增加了代码的可配置性。</li><li>异常处理改进：对于网络请求获取token和领取奖励的部分，添加了<code>try-catch</code>语句来捕获可能出现的异常，并给出相应的错误提示信息，提高了代码的健壮性。</li><li>邮件发送优化：根据不同的条件和配置，灵活地选择使用自定义邮箱还是默认的SMTP邮箱发送邮件。使用了模板字符串和配置变量，简化了邮件发送部分的代码。</li></ol><p>综上所述，对代码进行了结构优化、错误处理、日志输出优化以及变量命名优化，提高了代码的可读性、可维护性和错误处理能力，使得代码更加健壮和易于使用。</p><h3 id="_7-修改后的代码" tabindex="-1"><a class="header-anchor" href="#_7-修改后的代码" aria-hidden="true">#</a> <strong>7.修改后的代码：</strong></h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> myDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个表示当前时间的 Date 对象</span>
<span class="token keyword">var</span> data_time <span class="token operator">=</span> myDate<span class="token punctuation">.</span><span class="token function">toLocaleDateString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前日期的字符串表示</span>

<span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t <span class="token operator">&lt;=</span> d<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使程序暂停执行一段时间</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印消息到控制台</span>
  <span class="token comment">// TODO: 将日志写入文件</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> tokenColumn <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;A&quot;</span>
<span class="token keyword">var</span> signInColumn <span class="token operator">=</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;B&quot;</span>
<span class="token keyword">var</span> rewardColumn <span class="token operator">=</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;C&quot;</span>
<span class="token keyword">var</span> emailColumn <span class="token operator">=</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;F&quot;</span>
<span class="token keyword">var</span> sendEmailColumn <span class="token operator">=</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;G&quot;</span>
<span class="token keyword">var</span> resultColumn <span class="token operator">=</span> <span class="token string">&quot;J&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 设置列号变量为 &quot;J&quot;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 循环遍历从第 2 行到第 20 行的数据</span>
  <span class="token keyword">var</span> refresh_token <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>tokenColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sflq <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>signInColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sflqReward <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>rewardColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> jsyx <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>emailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sendEmail <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>sendEmailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> customEmailResult <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>resultColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>

  <span class="token keyword">var</span> emailConfigured <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_host <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_post <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值并转换为整数</span>
  <span class="token keyword">var</span> zdy_username <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_pasd <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否签到”为“是”</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>refresh_token <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果刷新令牌不为空</span>
      <span class="token comment">// 发起网络请求-获取token</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://auth.aliyundrive.com/v2/account/token&quot;</span><span class="token punctuation">,</span>
        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token string-property property">&quot;grant_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;refresh_token&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;refresh_token&quot;</span><span class="token operator">:</span> refresh_token
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将响应数据解析为 JSON 格式</span>
      <span class="token keyword">var</span> access_token <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;access_token&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取访问令牌</span>
      <span class="token keyword">var</span> phone <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取用户名</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>access_token <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果访问令牌未定义</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的token值错误，程序执行失败，请重新复制正确的token值&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// 跳过当前行的后续操作</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> access_token2 <span class="token operator">=</span> <span class="token string">&#39;Bearer &#39;</span> <span class="token operator">+</span> access_token<span class="token punctuation">;</span> <span class="token comment">// 构建包含访问令牌的请求头</span>
        <span class="token comment">// 签到</span>
        <span class="token keyword">let</span> data2 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_list&quot;</span><span class="token punctuation">,</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;_rx-s&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mobile&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        data2 <span class="token operator">=</span> data2<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将响应数据解析为 JSON 格式</span>
        <span class="token keyword">var</span> signin_count <span class="token operator">=</span> data2<span class="token punctuation">[</span><span class="token string">&#39;result&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;signInCount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取签到次数</span>

        <span class="token keyword">var</span> logMessage <span class="token operator">=</span> <span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 签到成功，本月累计签到 &quot;</span> <span class="token operator">+</span> signin_count <span class="token operator">+</span> <span class="token string">&quot; 天&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> rewardMessage <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>sflqReward <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否领取奖励”为“是”</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否签到”为“是”</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
              <span class="token comment">// 领取奖励</span>
              <span class="token keyword">let</span> data3 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
                <span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_reward?_rx-s=mobile&quot;</span><span class="token punctuation">,</span>
                <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;signInDay&quot;</span><span class="token operator">:</span> signin_count <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
              data3 <span class="token operator">=</span> data3<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将响应数据解析为 JSON 格式</span>
              <span class="token keyword">var</span> rewardName <span class="token operator">=</span> data3<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取奖励名称</span>
              <span class="token keyword">var</span> rewardDescription <span class="token operator">=</span> data3<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;description&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取奖励描述</span>
              rewardMessage <span class="token operator">=</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> rewardName <span class="token operator">+</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">+</span> rewardDescription<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> errorMessage <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error<span class="token punctuation">;</span> <span class="token comment">// 获取错误信息</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>errorMessage<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot; - 今天奖励已领取&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 今天奖励已领取&quot;</span><span class="token punctuation">;</span>
                  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">+</span> rewardMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 奖励领取失败：&quot;</span> <span class="token operator">+</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 奖励领取失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 奖励待领取&quot;</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 奖励待领取&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">log</span><span class="token punctuation">(</span>logMessage <span class="token operator">+</span> rewardMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>sendEmail <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否发送邮件”为“是”</span>
          <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> mailer<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>customEmailResult <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否自定义邮箱”为“是”</span>
              <span class="token keyword">var</span> customEmail <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>resultColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>emailConfigured <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果配置了自定义邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> zdy_host<span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> zdy_post<span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> zdy_username<span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> zdy_pasd<span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;&quot;</span> <span class="token operator">+</span> zdy_username <span class="token operator">+</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> customEmail<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 如果未配置自定义邮箱，默认使用示例邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;smtp.163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;fs8484848@163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;QADSEMPKDHDAVWVD&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;fs8484848@163.com&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> customEmail<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 已发送邮件至：&quot;</span> <span class="token operator">+</span> customEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否自定义邮箱”为“否”</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>emailConfigured <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果配置了自定义邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> zdy_host<span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> zdy_post<span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> zdy_username<span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> zdy_pasd<span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;&quot;</span> <span class="token operator">+</span> zdy_username <span class="token operator">+</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> jsyx<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 如果未配置自定义邮箱，默认使用示例邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;smtp.163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;fs8484848@163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;QADSEMPKDHDAVWVD&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;fs8484848@163.com&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> jsyx<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 已发送邮件至：&quot;</span> <span class="token operator">+</span> jsyx<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 发送邮件失败：&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的token签到失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// 跳过当前行的后续操作</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; 不签到&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> currentDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个表示当前时间的 Date 对象</span>
<span class="token keyword">var</span> currentDay <span class="token operator">=</span> currentDate<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前日期的天数</span>
<span class="token keyword">var</span> lastDayOfMonth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currentDate<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当月的最后一天的日期</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>currentDay <span class="token operator">===</span> lastDayOfMonth<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果当前日期是当月的最后一天</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 循环遍历从第 2 行到第 20 行的数据</span>
    <span class="token keyword">var</span> sflq <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>signInColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
    <span class="token keyword">var</span> sflqReward <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>rewardColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span> <span class="token operator">&amp;&amp;</span> sflqReward <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果“是否签到”和“是否领取奖励”均为“是”</span>
      <span class="token keyword">var</span> refresh_token <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>tokenColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
      <span class="token keyword">var</span> jsyx <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>emailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span> <span class="token comment">// 获取指定单元格的值</span>
      <span class="token keyword">var</span> phone <span class="token operator">=</span> <span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone<span class="token punctuation">;</span> <span class="token comment">// 构建账号信息字符串</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>refresh_token <span class="token operator">!==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果刷新令牌不为空</span>
        <span class="token comment">// 发起网络请求-获取token</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://auth.aliyundrive.com/v2/account/token&quot;</span><span class="token punctuation">,</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string-property property">&quot;grant_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;refresh_token&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;refresh_token&quot;</span><span class="token operator">:</span> refresh_token
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将响应数据解析为 JSON 格式</span>
        <span class="token keyword">var</span> access_token <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;access_token&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取访问令牌</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>access_token <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果访问令牌未定义</span>
          <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的token值错误，程序执行失败，请重新复制正确的token值&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// 跳过当前行的后续操作</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> access_token2 <span class="token operator">=</span> <span class="token string">&#39;Bearer &#39;</span> <span class="token operator">+</span> access_token<span class="token punctuation">;</span> <span class="token comment">// 构建包含访问令牌的请求头</span>
          <span class="token comment">// 领取奖励</span>
          <span class="token keyword">let</span> data4 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
            <span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_reward?_rx-s=mobile&quot;</span><span class="token punctuation">,</span>
            <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;signInDay&quot;</span><span class="token operator">:</span> lastDayOfMonth <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          data4 <span class="token operator">=</span> data4<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将响应数据解析为 JSON 格式</span>
          <span class="token keyword">var</span> claimStatus <span class="token operator">=</span> data4<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取奖励状态</span>
          <span class="token keyword">var</span> day <span class="token operator">=</span> lastDayOfMonth<span class="token punctuation">;</span> <span class="token comment">// 获取最后一天的日期</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>claimStatus <span class="token operator">===</span> <span class="token string">&quot;CLAIMED&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 第 &quot;</span> <span class="token operator">+</span> day <span class="token operator">+</span> <span class="token string">&quot; 天奖励领取成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 第 &quot;</span> <span class="token operator">+</span> day <span class="token operator">+</span> <span class="token string">&quot; 天奖励领取失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
          <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的token签到失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// 跳过当前行的后续操作</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; 不签到&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;自动领取未领取奖励完成。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-快速获取-token-值" tabindex="-1"><a class="header-anchor" href="#_8-快速获取-token-值" aria-hidden="true">#</a> 8.快速获取 token 值</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//在控制台输入</span>
<span class="token keyword">var</span> token <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;refresh_token:&#39;</span><span class="token punctuation">,</span> token<span class="token punctuation">.</span>refresh_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103751.webp" alt="img" loading="lazy"></p><p>打开控制台粘贴代码回车即可</p><h3 id="_9-如何获取自己的smtp" tabindex="-1"><a class="header-anchor" href="#_9-如何获取自己的smtp" aria-hidden="true">#</a> 9.如何获取自己的<strong>SMTP</strong></h3>`,15),v=n("strong",null,"这里我以网易邮箱为例：",-1),g=n("strong",null,"打开网易官网：",-1),b={href:"https://link.zhihu.com/?target=https%3A//mail.163.com/",target:"_blank",rel:"noopener noreferrer"},y=p('<p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103843.webp" alt="img" loading="lazy"></p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251103961.webp" alt="img" loading="lazy"></p><h3 id="_10-qq邮箱获取自己的smtp" tabindex="-1"><a class="header-anchor" href="#_10-qq邮箱获取自己的smtp" aria-hidden="true">#</a> 10.QQ邮箱获取自己的<strong>SMTP</strong></h3><p>首先要开启QQ邮箱的smtp服务，默认是关闭的。</p><p>登录QQ邮箱，点“设置” - “帐户”。</p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251105520.png" alt="img" loading="lazy"></p><p>找到“POP3/SMTP服务”和“IMAP/SMTP服务”项，点“开启”。</p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251105237.png" alt="img" loading="lazy"></p><p>开启之后，点击“生成授权码”。这个授权码将作为邮箱的<strong>身份认证密码</strong>。</p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251105452.png" alt="img" loading="lazy"></p><p>然后到系统后台，在“系统管理” - “系统设置” - “邮件设置”中进行设置。</p><p><img src="https://cdn.jsdelivr.net/gh/xiaou61/pictures/202307251105249.png" alt="img" loading="lazy"></p>',12),q={href:"http://smtp.qq.com",target:"_blank",rel:"noopener noreferrer"},h=n("li",null,"SMTP端口号：465。必须填这个端口号，否则会报错。",-1),f=n("li",null,[s("身份认证用户名：填完整的邮箱名，如："),n("code",null,"123456789@qq.com"),s("，包括"),n("code",null,"@qq.com"),s("部分。")],-1),w=n("li",null,[s("身份认证密码：填上述的QQ邮箱"),n("strong",null,"授权码"),s("。注意，不是QQ邮箱的登录密码。")],-1),_=n("li",null,"SMTP身份认证。选“是”。",-1),x=n("li",null,"SSL加密。选“是”。",-1),M=p(`<p>设置好之后，一定要先点“保存”，然后再进行邮件发送测试。测试邮件不要写“测试”、“123”之类的文字，以免被认为是垃圾邮件，被禁止发送。尽量模仿一篇正式的邮件进行发送测试。</p><p>如果配置不正确，不管哪一项的配置不正确，出现的错误信息基本都一样的，大致为:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>org.springframework.mail.MailAuthenticationException: Authentication failed; nested exception is javax.mail.AuthenticationFailedException: 530 Error: A secure connection is requiered(such as ssl). More information at http://service.mail.qq.com/cgi-bin/help?id=28
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果出现下面的错误信息，则是因为使用了QQ邮箱的登录密码或者是密码错误，应该使用上述的QQ邮箱<strong>授权码</strong>。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>org.springframework.mail.MailAuthenticationException: Authentication failed; nested exception is javax.mail.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,5),T={href:"https://link.zhihu.com/?target=http%3A//smtp.qq.com",target:"_blank",rel:"noopener noreferrer"},j=n("li",null,"SMTP端口号：465。必须填这个端口号，否则会报错",-1);function D(A,S){const a=e("ExternalLinkIcon");return c(),l("div",null,[u,n("p",null,[s("使用此代码一定要使用修改后的模版："),n("a",r,[s("https://kdocs.cn/l/ceQR4HpZ6op1"),t(a)])]),k,n("p",null,[s("修改后模版："),n("a",d,[s("https://kdocs.cn/l/ceQR4HpZ6op1"),t(a)])]),m,n("p",null,[v,g,n("a",b,[s("https://mail.163.com/"),t(a)]),s("，登录账号")]),y,n("ul",null,[n("li",null,[s("SMTP服务器："),n("a",q,[s("smtp.qq.com"),t(a)])]),h,f,w,_,x]),M,n("ul",null,[n("li",null,[s("SMTP服务器："),n("a",T,[s("http://smtp.qq.com"),t(a)])]),j])])}const R=o(i,[["render",D],["__file","6.html.vue"]]);export{R as default};
